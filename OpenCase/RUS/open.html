<!DOCTYPE html>
<html>
<head>
<title>Открытие кейса</title>
<script src="../scripts/jquery.min.js"></script>
<script src="../scripts/jquery.cookie.js"></script>
<script src="../scripts/main.js"></script>
<script src="../scripts/settings.js"></script>
<script src="../scripts/cases2.js"></script>
<script src="../scripts/quality.js"></script>
<script src="../scripts/skinNames.js"></script>
<script src="../scripts/prices.js"></script>
<script src="../scripts/openCase.js"></script>
<script src="../scripts/jquery-ui.min.js"></script>

<link rel="stylesheet" type="text/css" href="../css/animate.css">
<link rel="stylesheet" type="text/css" href="../css/main.css">
<link rel="stylesheet" type="text/css" href="../css/rarity.css">
<link rel="stylesheet" type="text/css" href="../css/fonts.css">
</head>
<body data-localization="openCase" data-inventory="no-load">

<div class="weapons">
<div class="closeCase"></div>

<div class="scrollerContainer">
	<div id="caruselOver"><div id="caruselLine"></div></div>
	<div id="aCanvas">
		<div class="casesCarusel">
		</div>
	</div>
</div>

<div class="win" style="display: none;">
<span id='win_youWon'>Вы выиграли</span>

<span class="win_name"></span>
<span class="win_quality"></span>
<span class="win_price"></span>
<img src="" class="win_img">
</div>

<button class="openCase">Открыть кейс</button>

<div><span id="opened-text">Открыто: </span><span id="opened">0</span></div>

<button id='what-i-can-win-Button'>Что я могу выиграть?</button>

<div id="youCanWin" style='display:none'><font id="local-youCanWin">Вы можете выиграть один из данных предметов из коллекции</font> <span></span></div>
<ul class="weaponsList" style='display:none'>
</ul>
</div>
<div id="caseID" style="display:none;"></div>
<script src="../scripts/main.js"></script>
<script src="../scripts/localization.js"></script>
<script>
if (typeof souvenirCase == 'undefined') var souvenirCase = false;
$(function(){
	var param = parseURLParams(window.location.href);
	if(typeof param != "undefined") {
		caseId = param.caseId[0];
		try {
			souvenirCase = param.souvenir[0] == 'true';
		} catch(e) {}
		$("#caseID").text(caseId);
		$("#youCanWin span").text(cases[caseId].name)
		var opened = 0;
		if (isAndroid())
			opened = parseInt(client.getStatistic("case-"+cases[caseId].name));
		else
			opened = $.cookie("case-"+cases[caseId].name, Number)
			
		$("#opened").text(opened);
		
		document.title = "Открытие кейса — "+cases[caseId].name;
		
		fillCarusel(caseId);
	}
});
$('#what-i-can-win-Button').on('click', function(){weaponList()});
function weaponList() {
	var rare = false;
	for (var i = 0; i < cases[caseId].weapons.length; i++) {
		var weapon = cases[caseId].weapons[i];
		if (weapon.rarity == 'rare' && rare == true)
			continue;
		var img = getImgUrl(weapon.img);

		var type = weapon.type;
		if (type.indexOf("|") != -1) {
			type = type.split("|")[1]
		}
		type = souvenirCase ? Localization.souvenir[Settings.language]+' '+type : type;

		var name = weapon.skinName;
		if (name.indexOf("|") != -1) {
			name = name.split("|")[1]
		}
		name = getSkinName(name, Settings.language);
		if (weapon.rarity == 'rare') {
			type = '★ Rare Special Item ★';
			name = '&nbsp;';
			img = '../images/Weapons/rare.png';
			rare = true;
		}
		var weaponInfo = "<img src='" + img + "'><div class='weaponInfo " + weapon.rarity + "'><span class='type'>" + type + "<br>" + name + "</span></div>";
		$(".weaponsList").append("<li class='weapon animated fadeInDown'>" + weaponInfo + "</li>");
	}
	$(".weaponsList").css("display", "block");
	$("#youCanWin").css("display", "block");
	$('#what-i-can-win-Button').css('display', 'none');
}

function isAndroid() {
	try {
		var a = client.isAndroid();
		return true;
	} catch (e) {
		return false;
	}
}
</script>
</body>
</html>