function startGame(){$("#coin").removeClass();var a=getRandomItem(["CT","T"],[Games[PlayerInGame].bot.chance,Games[PlayerInGame].player.chance]);animation=a,$(".game__start").css("display","none"),$(".addWeapons").addClass("hide"),$(".coin-blur").removeClass("hide"),$("#coin-flip-cont").removeClass("hide"),$("#coin").addClass(animation),flipSoundCT.currentTime=0,Settings.sounds&&flipSoundCT.play()}function coinStoped(){flipSoundCT.pause();var a=$("#coin").attr("class");if("CT"==a)$(".game__bot__img").addClass("winner-img");else if($(".game__player__img").addClass("winner-img"),isAndroid()){for(var b=0;b<PlayerBet.weapons.length;b++)PlayerBet.weapons[b].new=!0,saveWeapon(PlayerBet.weapons[b]);for(var b=0;b<Games[PlayerInGame].bot.weapons.length;b++)Games[PlayerInGame].bot.weapons[b].new=!0,saveWeapon(Games[PlayerInGame].bot.weapons[b])}else{for(var b=0;b<PlayerBet.weapons.length;b++)PlayerBet.weapons[b].new=!0,inventory.push(PlayerBet.weapons[b]);for(var b=0;b<Games[PlayerInGame].bot.weapons.length;b++)Games[PlayerInGame].bot.weapons[b].new=!0,inventory.push(Games[PlayerInGame].bot.weapons[b]);saveInventory()}Games[PlayerInGame].winner=a,Games[PlayerInGame].player.weapons=[],Games[PlayerInGame].player.items_cost=PlayerBet.items_cost;for(var b=0;b<PlayerBet.weapons.length;b++)Games[PlayerInGame].player.weapons.push(PlayerBet.weapons[b]);checkInventoryForNotification(),timerId=setTimeout(function(){hideCoin()},2e3)}function hideCoin(){flipSoundCT.pause(),clearTimeout(timerId),timerId=null;var a=$("#coin").attr("class");$(".coin-blur").addClass("hide"),$("#coin-flip-cont").addClass("hide"),PlayerBet={},$($(".join")[PlayerInGame]).text(Localization.coinflip2.view[Settings.language]),PlayerInGame=!1,maxItems=maxWeapons,$(".game__table__win").html(Localization.coinflip2.winner[Settings.language]+'<br><img src="../images/coinflip/'+a.toLowerCase()+'.png">')}function showGame(a){$(".addWeapons").removeClass("hide"),$(".game__bot__nick").text(Games[a].bot.name),$(".game__bot__img").attr("src","../images/ava/"+Games[a].bot.img),$(".game__bot__price").text("$"+Games[a].bot.items_cost.toFixed(2)),$(".game__player__nick").text(Player.nickname),$(".game__player__img").attr("src","../images/ava/"+Player.avatar),$(".game__player__price").text("$0"),$(".game__player__chance").text("0%"),$(".game__table__win").html("");var b=Games[a].bot.weapons;$(".player-inventory tr").remove(),$(".bot-inventory tr").remove();for(var c=0;c<b.length;c++){var d=b[c];"RU"!=Settings.language&&d.type.indexOf("Сувенир")!=-1&&(d.type=d.type.replace("Сувенир","Souvenir"));var e="<tr><td class='"+d.rarity+"-color inv_rarity'></td><td><span class='inv_type'>"+d.type+"</span><span class='inv_name'>"+d.skinName+"</span></td><td class='inv_price'>$"+d.price+"</td></tr>";$(".bot-inventory").append(e)}if(PlayerInGame===!1&&"undefined"==typeof Games[a].winner)$(".player-inventory").append('<tr><td class="addWeapons" data-game-id="'+a+'">'+Localization.coinflip2.add_weapons[Settings.language]+"</td></tr>"),$(".game__start").css("display","none");else if("undefined"==typeof Games[a].winner&&0!=PlayerBet.weapons.length){$(".game__player__price").text("$"+PlayerBet.items_cost.toFixed(2));for(var c=0;c<PlayerBet.weapons.length;c++){var d=PlayerBet.weapons[c];"RU"!=Settings.language&&d.type.indexOf("Сувенир")!=-1&&(d.type=d.type.replace("Сувенир","Souvenir"));var e="<tr><td class='inv_price'>$"+d.price+"</td><td><span class='inv_type'>"+d.type+"</span><span class='inv_name'>"+d.skinName+"</span></td><td class='"+d.rarity+"-color inv_rarity'></td></tr>";$(".player-inventory").append(e)}$(".game__start").css("display","block"),PlayerBet.weapons.length<maxWeapons&&(maxItems=maxWeapons-PlayerBet.weapons.length,$(".player-inventory").append('<tr><td colspan="3" class="addWeapons" data-game-id="'+a+'">'+Localization.coinflip2.add_weapons[Settings.language]+"</td></tr>"));var f=Games[a].bot.items_cost+PlayerBet.items_cost,g=100*Games[a].bot.items_cost/f,h=100*PlayerBet.items_cost/f;Games[a].bot.chance=g,Games[a].player.chance=h,$(".game__bot__chance").text(g.toFixed(1)+"%"),$(".game__player__chance").text(h.toFixed(1)+"%")}else if("undefined"!=typeof Games[a].winner){"CT"==Games[a].winner?$(".game__bot__img").addClass("winner-img"):$(".game__player__img").addClass("winner-img"),$(".game__player__chance").text(Games[a].player.chance.toFixed(1)+"%"),$(".game__player__price").text("$"+Games[a].player.items_cost.toFixed(2)),$(".game__bot__chance").text(Games[a].bot.chance.toFixed(1)+"%"),$(".game__start").css("display","none"),$(".game__table__win").html(Localization.coinflip2.winner[Settings.language]+'<br><img src="../images/coinflip/'+Games[a].winner.toLowerCase()+'.png">');for(var c=0;c<Games[a].player.weapons.length;c++){var d=Games[a].player.weapons[c];"RU"!=Settings.language&&d.type.indexOf("Сувенир")!=-1&&(d.type=d.type.replace("Сувенир","Souvenir"));var e="<tr><td class='inv_price'>$"+d.price+"</td><td><span class='inv_type'>"+d.type+"</span><span class='inv_name'>"+d.skinName+"</span></td><td class='"+d.rarity+"-color inv_rarity'></td></tr>";$(".player-inventory").append(e)}}$(".blur").css("display","block"),$(".game").css("display","block")}function botAddGame(a){var b={};b.name=getRandomBotName(),b.img=getRandomBotImg(),b.weapons=[],b.items_cost=0;for(var c=Math.rand(3,maxWeapons),d=0;d<c;d++){var e=Math.rand(0,Prices.length-1),f=Prices[e],g=0==f.marketPrice?f.avgPrice:f.marketPrice;if(g>priceRange[a].min&&g<priceRange[a].max){for(var h=f.type,i=getSkinName(f.name),j=getQualityName(f.quality,Settings.language),k=!1,l=0;l<cases.length;l++){for(var m=0;m<cases[l].weapons.length;m++)if(cases[l].weapons[m].type==h&&getSkinName(cases[l].weapons[m].skinName)==i){var n={};for(var o in cases[l].weapons[m])n[o]=cases[l].weapons[m][o];n.skinName=getSkinName(i,Settings.language),n.price=g,n.statTrak="undefined"!=typeof f.statTrak,n.quality=j,b.weapons.push(n),b.items_cost+=g,k=!0;break}if(k)break}k||c++}else c++}var p="";b.items_cost<100&&(p="consumer-color"),b.items_cost>100&&b.items_cost<500&&(p="milspec-color"),b.items_cost>500&&b.items_cost<1e3&&(p="restricted-color"),b.items_cost>1e3&&b.items_cost<3e3&&(p="classified-color"),b.items_cost>3e3&&b.items_cost<8e3&&(p="covert-color"),b.items_cost>8e3&&(p="rare-color");var q={};return q.color=p,q.bot=b,q.player={},q}var Games=[],PlayerBet={},maxWeapons=15,maxItems=maxWeapons,PlayerInGame=!1,priceRange={low:{min:20,max:60},normal:{min:60,max:120},hight:{min:120,max:350},legendary:{min:350,max:999999}},timerId=0,flipSoundCT=new Audio;flipSoundCT.src="../sound/coinFlip.wav",flipSoundCT.volume=.7,flipSoundCT.loop=!0;var clickSound=new Audio;clickSound.src="../sound/interface/menuClick.wav",clickSound.volume=.9,$(window).load(function(){var a=document.getElementById("coin");a.addEventListener("animationend",coinStoped,!1);for(var b=["low","low","normal","normal","hight","hight","legendary","legendary"],c="",d=0;d<b.length;d++){var e=botAddGame(b[d]);Games.push(e)}Games=Games.sort(function(a,b){return parseFloat(a.bot.items_cost)-parseFloat(b.bot.items_cost)});for(var d=0;d<Games.length;d++)c+="<tr><td class='table-name'><img src='../images/ava/"+Games[d].bot.img+"'><span>"+Games[d].bot.name+"</span></td><td>"+Games[d].bot.weapons.length+" items</td><td>$"+Games[d].bot.items_cost.toFixed(2)+"</td><td><span class='join "+Games[d].color+"' data-game-id="+d+">"+Localization.coinflip2.join[Settings.language]+"</span></td></tr>";$(".games").append(c),$("#js-table-loading-gif").remove()}),$(document).ready(function(){$(".navigationBar").append('<img src="../images/navigation/refresh.png" class="navigationBar_refresh">')}),$(document).on("click",".navigationBar_refresh",function(){location.reload()}),$(document).on("click",".game__start span",function(){startGame()});var getRandomItem=function(a,b){for(var c=100,d=Math.rand(0,c),e=0,f=0;f<a.length;f++)if(e+=b[f],e=+e.toFixed(2),d<=e)return a[f]};$(document).on("click",".addWeapons",function(){PlayerInGame=$(this).data("game-id"),Settings.sounds&&clickSound.play(),fillInventory()}),$(document).on("click",".join",function(){"undefined"!=typeof PlayerBet.weapons&&(PlayerInGame=$(this).data("game-id")),Settings.sounds&&clickSound.play(),showGame($(this).data("game-id")),$("#coin").removeClass()}),$(document).on("click",".close-game, .blur",function(){$(".game__bot__img").removeClass("winner-img"),$(".game__player__img").removeClass("winner-img"),$(".game").css("display","none"),$(".blur").css("display","none"),Settings.sounds&&clickSound.play()}),$(document).on("click",".choseItems",function(){var a=$(".inventoryItemSelected").length,c=[];if(Settings.sounds&&clickSound.play(),0!=a){if("undefined"==typeof PlayerBet.nick&&(PlayerBet={nick:Player.nickname,chance:0,items_cost:0},PlayerBet.weapons=[]),isAndroid())$(".inventoryItemSelected").each(function(){PlayerBet.weapons.push(getWeapon(parseInt($(this).data("id")))),PlayerBet.items_cost+=getWeapon(parseInt($(this).data("id"))).price,deleteWeapon($(this).data("id"))}),$("#js-loading-inventory").remove();else{$(".inventoryItemSelected").each(function(){PlayerBet.weapons.push(inventory[parseInt(this.id)]),PlayerBet.items_cost+=inventory[parseInt(this.id)].price,c.push(parseInt(this.id))});for(var d=0;d<c.length;d++){var e=c[c.length-d-1];inventory.splice(e,1)}saveInventory()}$(".inventoryList").css("display","none"),$("#inventorySum").remove(),showGame(PlayerInGame)}}),$(document).on("click",".closeInventory",function(){"undefined"==typeof PlayerBet.items_cost&&(PlayerInGame=!1),Settings.sounds&&clickSound.play()});