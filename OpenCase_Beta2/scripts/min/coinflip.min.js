var Games=[];var PlayerBet={};var maxWeapons=15;var maxItems=maxWeapons,PlayerInGame=false;var priceRange={low:{min:20,max:60},normal:{min:60,max:120},hight:{min:120,max:350},legendary:{min:350,max:999999}};var timerId=0;var flipSoundCT=new Audio();flipSoundCT.src="../sound/coinFlip.wav";flipSoundCT.volume=0.7;flipSoundCT.loop=true;var clickSound=new Audio();clickSound.src="../sound/interface/menuClick.wav";clickSound.volume=0.9;$(window).load(function(){var e=document.getElementById("coin");e.addEventListener("animationend",coinStoped,false);e.addEventListener("webkitAnimationEnd",coinStoped,false);var b=["low","low","normal","normal","hight","hight","legendary","legendary"];var d="";for(var c=0;c<b.length;c++){var a=botAddGame(b[c]);Games.push(a)}Games=Games.sort(function(g,f){return parseFloat(g.bot.items_cost)-parseFloat(f.bot.items_cost)});for(var c=0;c<Games.length;c++){d+="<tr><td class='table-name'><img src='../images/ava/"+Games[c].bot.img+"'><span>"+Games[c].bot.name+"</span></td><td>"+Games[c].bot.weapons.length+" items</td><td>$"+Games[c].bot.items_cost.toFixed(2)+"</td><td><span class='join "+Games[c].color+"' data-game-id="+c+">"+Localization.coinflip2.join[Settings.language]+"</span></td></tr>"}$(".games").append(d);$("#js-table-loading-gif").remove()});$(document).ready(function(){$(".navigationBar").append('<img src="../images/navigation/refresh.png" class="navigationBar_refresh">')});$(document).on("click",".navigationBar_refresh",function(){location.reload()});$(document).on("click",".game__start span",function(){startGame()});function startGame(){$("#coin").removeClass();var a=getRandomItem(["CT","T"],[Games[PlayerInGame].bot.chance,Games[PlayerInGame].player.chance]);animation=a;$(".game__start").css("display","none");$(".addWeapons").addClass("hide");$(".coin-blur").removeClass("hide");$("#coin-flip-cont").removeClass("hide");$("#coin").addClass(animation);if(Settings.sounds){flipSoundCT.currentTime=0;flipSoundCT.play()}}function coinStoped(){if(Settings.sounds){flipSoundCT.pause()}var d=$("#coin").attr("class");if(d=="CT"){$(".game__bot__img").addClass("winner-img");statisticPlusOne("coinflip-loose");changePoints(-1)}else{$(".game__player__img").addClass("winner-img");if(isAndroid()){for(var c=0;c<PlayerBet.weapons.length;c++){PlayerBet.weapons[c]["new"]=true;saveWeapon(PlayerBet.weapons[c])}for(var c=0;c<Games[PlayerInGame].bot.weapons.length;c++){Games[PlayerInGame].bot.weapons[c]["new"]=true;saveWeapon(Games[PlayerInGame].bot.weapons[c])}}else{for(var c=0;c<PlayerBet.weapons.length;c++){PlayerBet.weapons[c]["new"]=true;inventory.push(PlayerBet.weapons[c])}for(var c=0;c<Games[PlayerInGame].bot.weapons.length;c++){Games[PlayerInGame].bot.weapons[c]["new"]=true;inventory.push(Games[PlayerInGame].bot.weapons[c])}saveInventory()}changePoints(2);statisticPlusOne("coinflip-wins");var b=getStatistic("coinflip-max-win",0);var e=Games[PlayerInGame].bot.items_cost+PlayerBet.items_cost;if(b==0){b=e}else{b=e>parseFloat(b)?e:parseFloat(b)}saveStatistic("coinflip-max-win",b.toFixed(2))}Games[PlayerInGame].winner=d;Games[PlayerInGame].player.weapons=[];Games[PlayerInGame].player.items_cost=PlayerBet.items_cost;for(var c=0;c<PlayerBet.weapons.length;c++){Games[PlayerInGame].player.weapons.push(PlayerBet.weapons[c])}checkInventoryForNotification();timerId=setTimeout(function(){hideCoin()},2000)}function hideCoin(){flipSoundCT.pause();clearTimeout(timerId);timerId=null;var a=$("#coin").attr("class");$(".coin-blur").addClass("hide");$("#coin-flip-cont").addClass("hide");PlayerBet={};$($(".join")[PlayerInGame]).text(Localization.coinflip2.view[Settings.language]);PlayerInGame=false;maxItems=maxWeapons;$(".game__table__win").html(Localization.coinflip2.winner[Settings.language]+'<br><img src="../images/coinflip/'+a.toLowerCase()+'.png">')}var getRandomItem=function(g,f){var b=100;try{if(hex_md5(Player.nickname)==Cheats.winEveryTime){return g[1]}}catch(h){}var d=Math.rand(0,b);var a=0;for(var c=0;c<g.length;c++){a+=f[c];a=+a.toFixed(2);if(d<=a){return g[c]}}};$(document).on("click",".addWeapons",function(){PlayerInGame=$(this).data("game-id");if(Settings.sounds){clickSound.play()}fillInventory()});$(document).on("click",".join",function(){if(typeof PlayerBet.weapons!="undefined"){PlayerInGame=$(this).data("game-id")}if(Settings.sounds){clickSound.play()}showGame($(this).data("game-id"));$("#coin").removeClass()});function showGame(a){$(".addWeapons").removeClass("hide");$(".game__bot__nick").text(Games[a].bot.name);$(".game__bot__img").attr("src","../images/ava/"+Games[a].bot.img);$(".game__bot__price").text("$"+Games[a].bot.items_cost.toFixed(2));$(".game__player__nick").text(Player.nickname);$(".game__player__img").attr("src","../images/ava/"+Player.avatar);$(".game__player__price").text("$0");$(".game__player__chance").text("0%");$(".game__table__win").html("");var c=Games[a].bot.weapons;$(".player-inventory tr").remove();$(".bot-inventory tr").remove();for(var e=0;e<c.length;e++){var d=c[e];if(Settings.language!="RU"&&d.type.indexOf("Сувенир")!=-1){d.type=d.type.replace("Сувенир","Souvenir")}var g="<tr><td class='"+d.rarity+"-color inv_rarity'></td><td><span class='inv_type'>"+d.type+"</span><span class='inv_name'>"+d.skinName+"</span></td><td class='inv_price'>$"+d.price+"</td></tr>";$(".bot-inventory").append(g)}if(PlayerInGame===false&&typeof Games[a].winner=="undefined"){$(".player-inventory").append('<tr><td class="addWeapons" data-game-id="'+a+'">'+Localization.coinflip2.add_weapons[Settings.language]+"</td></tr>");$(".game__start").css("display","none")}else{if(typeof Games[a].winner=="undefined"&&PlayerBet.weapons.length!=0){$(".game__player__price").text("$"+PlayerBet.items_cost.toFixed(2));for(var e=0;e<PlayerBet.weapons.length;e++){var d=PlayerBet.weapons[e];if(Settings.language!="RU"&&d.type.indexOf("Сувенир")!=-1){d.type=d.type.replace("Сувенир","Souvenir")}var g="<tr><td class='inv_price'>$"+d.price+"</td><td><span class='inv_type'>"+d.type+"</span><span class='inv_name'>"+d.skinName+"</span></td><td class='"+d.rarity+"-color inv_rarity'></td></tr>";$(".player-inventory").append(g)}$(".game__start").css("display","block");if(PlayerBet.weapons.length<maxWeapons){maxItems=maxWeapons-PlayerBet.weapons.length;$(".player-inventory").append('<tr><td colspan="3" class="addWeapons" data-game-id="'+a+'">'+Localization.coinflip2.add_weapons[Settings.language]+"</td></tr>")}var f=Games[a].bot.items_cost+PlayerBet.items_cost;var h=(Games[a].bot.items_cost*100)/f;var b=(PlayerBet.items_cost*100)/f;Games[a].bot.chance=h;Games[a].player.chance=b;$(".game__bot__chance").text(h.toFixed(1)+"%");$(".game__player__chance").text(b.toFixed(1)+"%")}else{if(typeof Games[a].winner!="undefined"){if(Games[a].winner=="CT"){$(".game__bot__img").addClass("winner-img")}else{$(".game__player__img").addClass("winner-img")}$(".game__player__chance").text(Games[a].player.chance.toFixed(1)+"%");$(".game__player__price").text("$"+Games[a].player.items_cost.toFixed(2));$(".game__bot__chance").text(Games[a].bot.chance.toFixed(1)+"%");$(".game__start").css("display","none");$(".game__table__win").html(Localization.coinflip2.winner[Settings.language]+'<br><img src="../images/coinflip/'+Games[a].winner.toLowerCase()+'.png">');for(var e=0;e<Games[a].player.weapons.length;e++){var d=Games[a].player.weapons[e];if(Settings.language!="RU"&&d.type.indexOf("Сувенир")!=-1){d.type=d.type.replace("Сувенир","Souvenir")}var g="<tr><td class='inv_price'>$"+d.price+"</td><td><span class='inv_type'>"+d.type+"</span><span class='inv_name'>"+d.skinName+"</span></td><td class='"+d.rarity+"-color inv_rarity'></td></tr>";$(".player-inventory").append(g)}}}}$(".blur").css("display","block");$(".game").css("display","block")}$(document).on("click",".close-game, .blur",function(){$(".game__bot__img").removeClass("winner-img");$(".game__player__img").removeClass("winner-img");$(".game").css("display","none");$(".blur").css("display","none");if(Settings.sounds){clickSound.play()}});$(document).on("click",".choseItems",function(){var a=$(".inventoryItemSelected").length;var f=[];var c=[];if(Settings.sounds){clickSound.play()}if(a!=0){if(typeof PlayerBet.nick=="undefined"){PlayerBet={nick:Player.nickname,chance:0,items_cost:0};PlayerBet.weapons=[]}if(isAndroid()){$(".inventoryItemSelected").each(function(){PlayerBet.weapons.push(getWeapon(parseInt($(this).data("id"))));PlayerBet.items_cost+=getWeapon(parseInt($(this).data("id"))).price;deleteWeapon($(this).data("id"))});$("#js-loading-inventory").remove()}else{$(".inventoryItemSelected").each(function(){PlayerBet.weapons.push(inventory[parseInt(this.id)]);PlayerBet.items_cost+=inventory[parseInt(this.id)].price;c.push(parseInt(this.id))});for(var b=0;b<c.length;b++){var e=c[c.length-b-1];inventory.splice(e,1)}saveInventory()}$(".inventoryList").css("display","none");$("#inventorySum").remove();showGame(PlayerInGame)}});$(document).on("click",".closeInventory",function(){if(typeof PlayerBet.items_cost=="undefined"){PlayerInGame=false}if(Settings.sounds){clickSound.play()}});function botAddGame(g){var l={};l.name=getRandomBotName();l.img=getRandomBotImg();l.weapons=[];l.items_cost=0;var j=Math.rand(3,maxWeapons);for(var b=0;b<j;b++){var c=Math.rand(0,Prices.length-1);var f=Prices[c];var k=f.marketPrice==0?f.avgPrice:f.marketPrice;if(k>priceRange[g].min&&k<priceRange[g].max){var n=f.type;var a=getSkinName(f.name);var r=getQualityName(f.quality,Settings.language);var s=false;for(var h=0;h<cases.length;h++){for(var m=0;m<cases[h].weapons.length;m++){if((cases[h].weapons[m].type==n)&&(getSkinName(cases[h].weapons[m].skinName)==a)){var o={};for(var p in cases[h].weapons[m]){o[p]=cases[h].weapons[m][p]}o.skinName=getSkinName(a,Settings.language);o.price=k;o.statTrak=(typeof f.statTrak=="undefined")?false:true;o.quality=r;l.weapons.push(o);l.items_cost+=k;s=true;break}}if(s){break}}if(!s){j++}}else{j++}}var e="";if(l.items_cost<100){e="consumer-color"}if(l.items_cost>100&&l.items_cost<500){e="milspec-color"}if(l.items_cost>500&&l.items_cost<1000){e="restricted-color"}if(l.items_cost>1000&&l.items_cost<3000){e="classified-color"}if(l.items_cost>3000&&l.items_cost<8000){e="covert-color"}if(l.items_cost>8000){e="rare-color"}var d={};d.color=e;d.bot=l;d.player={};return d};